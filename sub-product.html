<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Pretendard Font -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pretendard@1.3.8/dist/web/static/pretendard.css" />
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
    <link rel="stylesheet" href="./assets/css/common.css" />
    <link rel="stylesheet" href="./assets/css/sub-product.css" />
    <title>인바이러스테크</title>
</head>

<body>
    <header class="site-header">
        <a href="/" class="mobile-logo"><img src="./assets/img/logo.png" alt="InVirusTech Logo" /></a>
        <button class="hamburger" aria-controls="sidebar" aria-expanded="false" aria-label="Open menu">
            <i class="fa-solid fa-bars"></i>
        </button>
    </header>
    
    <nav class="sidebar">
        <a href="/" class="logo"><img src="./assets/img/logo.png" alt="InVirusTech Logo" /></a>
        <a class="menu-item" data-cat="all">ALL</a>
        <a class="menu-item" data-cat="life-science">Life Science</a>
        <a class="menu-item" data-cat="molecular-diagnostic">Molecular diagnostic</a>
        <a class="menu-item" data-cat="plastic-ware">Plastic ware</a>
        <a class="menu-item" data-cat="others">Others</a>
        <a href="sub-company.html" class="menu-item">Company</a>
        <a href="sub-inquiry.html" class="menu-item">Inquiry</a>
        <div class="footer">www.invirustech.com</div>
    </nav>

    <div class="content">
        <section class="product-section">
            <h1 class="title"></h1>

            <div class="products-grid">
                <!-- <a href="sub-product-detail.html" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation RNA</p>
                        <h2 class="product-name">Clear-S™<br>Total RNA extraction ki<br>(50rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation RNA</p>
                        <h2 class="product-name">Clear-S™<br>miRNA extraction kit<br>(100rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation RNA</p>
                        <h2 class="product-name">Clear-S™<br>Super Plant RNA extraction kit<br>(50rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation RNA</p>
                        <h2 class="product-name">Clear-S™<br>Quick DNA extraction kit<br>(100rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation RNA</p>
                        <h2 class="product-name">Clear-S™<br>Plasmid Miniprep kit<br>(200rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation RNA</p>
                        <h2 class="product-name">Clear-S™<br>PCR/Gel DNA fragment<br>(200rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation RNA</p>
                        <h2 class="product-name">Clear-S™<br>Beniprep® DNA Swift<br>extraction solution<br>(250/500rxn)
                        </h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation RNA</p>
                        <h2 class="product-name">Beniprep®<br>Soil/Fecal DNA extraction kit<br>(50rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation RNA</p>
                        <h2 class="product-name">Clear-S™<br>Tissue DNA extraction kit<br>(50rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation<br>Total Nucleic acid extraction kit</p>
                        <h2 class="product-name">Clear-S™<br>Total DNA/RNA extraction kit<br>(50rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation<br>Total Nucleic acid extraction kit</p>
                        <h2 class="product-name">Beniprep®<br>Pathogen DNA/RNA<br>extraction kit (100rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation<br>Total Nucleic acid extraction kit</p>
                        <h2 class="product-name">Beniprep®<br>Magnetic Nucleic acid extraction kit (100rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation<br>Total Nucleic acid extraction kit</p>
                        <h2 class="product-name">Beniprep®<br>Super Plant Total Nucleic acid extraction kit (50rxn)</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation<br>Related Products</p>
                        <h2 class="product-name">Bulk buffer</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation<br>Related Products</p>
                        <h2 class="product-name">Enzyme</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">Sample Preparation<br>Related Products</p>
                        <h2 class="product-name">Column and tube</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a>

                <a href="#" class="product-card">
                    <div class="card-text">
                        <p class="product-category">PCR polymerase</p>
                        <h2 class="product-name">Real-time PCR<br>Hot-start PCR</h2>
                    </div>
                    <img class="product-img" src="./assets/img/sub-product01.png" alt="product image">
                </a> -->
            </div>
        </section>
    </div>

    <footer class="main-footer">
        <div class="footer-left">
            <p>Address. (61011) 607, 17-11, Cheomdangwagi-ro 208beon-gil, Buk-gu, Gwangju, Republic of Korea</p>
            <p>Email. invirustech@invirustech.com</p>
            <div class="contacts">
                <div><strong>Tel</strong> <span>+82 062-511-0682</span></div>
                <div><strong>Fax</strong> <span>+82 062-531-0682</span></div>
            </div>
        </div>
        <div class="footer-right">
            <img src="./assets/img/footer-logo.png" alt="InVirusTech Logo" />
            <p>© 2025 InVirusTech Inc. All Rights Reserved.</p>
        </div>
    </footer>

    <!-- jQuery v3.7.1 -->
    <script src="https://code.jquery.com/jquery-3.7.1.min.js"></script>
    <script src="./assets/js/common.js"></script>

    <script>
        const DATA_BASE = './data/';
        const CATEGORY_FILES = {
            'life-science': 'life-science.json',
            'molecular-diagnostic': 'molecular-diagnostic.json',
            'plastic-ware': 'plastic-ware.json',
            'others': 'others.json'
        };

        const cache = new Map();
        async function loadJSON(p) {
            if (cache.has(p)) return cache.get(p);
            const pr = fetch(p, { cache: 'no-store' }).then(async (r) => {
                if (!r.ok) throw new Error(`HTTP ${r.status} @ ${r.url}`);
                return r.json();
            });
            cache.set(p, pr);
            return pr;
        }

        async function getProductsByCategory(cat) {
            if (cat === 'all') {
                const files = Object.values(CATEGORY_FILES).map(f => loadJSON(DATA_BASE + f));
                const results = await Promise.allSettled(files);
                const ok = results
                    .filter(r => r.status === 'fulfilled')
                    .map(r => r.value.products || []);
                return ok.flat();
            }
            const file = CATEGORY_FILES[cat] || CATEGORY_FILES['life-science'];
            const data = await loadJSON(DATA_BASE + file);
            return data.products || [];
        }

        $(async function () {
            const params = new URLSearchParams(location.search);
            const cat = (params.get('cat') || 'life-science').toLowerCase();

            const listPageHref = 'sub-product.html';

            $('.sidebar .menu-item[data-cat]').each(function () {
                const key = String($(this).data('cat') || '').toLowerCase();
                $(this).attr('href', `${listPageHref}?cat=${encodeURIComponent(key)}`);

                const isActive = key === cat;
                $(this).toggleClass('on', isActive);
                if (isActive) $(this).attr('aria-current', 'page');
                else $(this).removeAttr('aria-current');
            });

            const titleMap = {
                'life-science': 'Life Science',
                'molecular-diagnostic': 'Molecular Diagnostic',
                'plastic-ware': 'Plastic Ware',
                'others': 'Others',
                'all': 'All Products'
            };
            $('.product-section .title').text(titleMap[cat] || 'Products');

            try {
                const items = await getProductsByCategory(cat);
                const html = items.map(p => {
                    const hasThumb = !!(p.thumbnail && String(p.thumbnail).trim() !== '');
                    const safeName = String(p.name || '').replace(/<[^>]*>/g, '');

                    return `
                        <a class="product-card" href="sub-product-detail.html?pid=${encodeURIComponent(p.slug)}">
                            <div class="card-text">
                                <p class="product-category">${p.categoryLabel || ''}</p>
                                <h2 class="product-name">${p.name}</h2>
                            </div>
                            ${hasThumb ? `<img class="product-img" src="${p.thumbnail}" alt="${safeName}">` : ''}
                        </a>
                    `;
                }).join('');

                $('.products-grid').html(html || '<p style="padding:20px">No products to display.</p>');
            } catch (e) {
                console.error('[LIST] load failed:', e);
                $('.products-grid').html('<p style="padding:20px">Failed to load product list.</p>');
            }

        });
    </script>

</body>

</html>